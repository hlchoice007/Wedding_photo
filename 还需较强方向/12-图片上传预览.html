<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>图片上传预览</title>
<script type="text/javascript">
    function imgPreview(fileDom,id,id1){
    if (window.FileReader) {
        var reader = new FileReader();
    } else {
        alert("您的设备不支持图片预览功能，如需该功能请升级您的设备！");
    }
    //获取文件
    var file = fileDom.files[0];
    // 正则表达式
    console.log(file.name)
    var tis=/^\b.+\b\.\bpng|jpeg|gif\b$/i;
    if(file.size>=1024*1024){
        $(id1).innerHTML='图片太大了';
        $(id1).style.color='red';
        return;
    }
    else if(!tis.test(file.name)){
        $(id1).innerHTML='图片格式不正确';
        $(id1).style.color='red';
        return; 
    }
    else{
        var imageType = /^image\//;
        //是否是图片
        if (!imageType.test(file.type)) {
            alert("请选择图片！");
            return;
        }
        reader.onload = function(e) {
            //获取图片dom
            var img = document.getElementById(id);
            img.src = e.target.result;
        };
        reader.readAsDataURL(file);
    }
    
}

function $(id){
    return document.getElementById(id);
}
</script>
</head>
<body>
    <img id="preview" />
    <br />
    <input type="file" name="file" onchange="imgPreview(this,'preview','id1')" />
    <div id="id1"></div>
</body>
</html>